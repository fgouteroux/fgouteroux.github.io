<section class="resume-section p-3 p-lg-5 d-flex flex-column" id="experience">
  <div class="my-auto" id="experience-content">
  <h2 class="mb-5">{{ i18n "experience" }}</h2>
    {{ range $.Data.experience }}
        {{- $duration := "" -}}
        {{- $range := .range -}}
        {{- if strings.Contains $range " - " -}}
          {{- $parts := split $range " - " -}}
          {{- $start := index $parts 0 -}}
          {{- $end := index $parts 1 -}}

          {{- $monthMap := dict "January" "1" "February" "2" "March" "3" "April" "4" "May" "5" "June" "6" "July" "7" "August" "8" "September" "9" "October" "10" "November" "11" "December" "12" -}}

          {{- $startParts := split $start " " -}}
          {{- $startMonth := index $monthMap (index $startParts 0) -}}
          {{- $startYear := index $startParts 1 -}}

          {{- $endMonth := "" -}}
          {{- $endYear := "" -}}
          {{- if eq $end "Present" -}}
            {{- $endMonth = printf "%d" now.Month -}}
            {{- $endYear = printf "%d" now.Year -}}
          {{- else -}}
            {{- $endParts := split $end " " -}}
            {{- $endMonth = index $monthMap (index $endParts 0) -}}
            {{- $endYear = index $endParts 1 -}}
          {{- end -}}

          {{- $totalMonths := sub (add (mul (sub (int $endYear) (int $startYear)) 12) (int $endMonth)) (int $startMonth) -}}
          {{- $years := div $totalMonths 12 -}}
          {{- $months := mod $totalMonths 12 -}}

          {{- if gt $years 0 -}}
            {{- $duration = printf "%d yr" $years -}}
            {{- if gt $months 0 -}}
              {{- $duration = printf "%s %d mo" $duration $months -}}
            {{- end -}}
          {{- else if gt $totalMonths 0 -}}
            {{- $duration = printf "%d mo" $totalMonths -}}
          {{- end -}}
        {{- end -}}

        <div class="resume-item d-flex flex-column flex-md-row mb-5">
          <div class="resume-content mr-auto">
            <h3 class="mb-0">{{ .role }}</h3>
            <div class="subheading mb-3">{{ .company | markdownify }}</div>
            <p>{{ .summary | markdownify }}</p>
          </div>
          <div class="resume-date text-md-right">
            <span class="text-primary">{{ .range }}</span>
            {{ if $duration }}
            <br><span class="text-muted">({{ $duration }})</span>
            {{ end }}
          </div>
        </div>
    {{ end }}
  </div>

</section>
